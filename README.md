# Rubbish_Classfication

## Данный проект выполнил Воронцов Александр

## Назначение

В наше время проблема экологической ситуации достаточна остра. Одним из ключевым аспектов этой проблемы является перераотка мусора. 
Для решения которой мосуор необходимо сортировать. Сейчас повсеместно устнавливаются урны для раздельного сбора мусора.
Для многих людей эта система нова и им тяжело определить каким отсеком нужно воспользоваться. Если определять его неправильно, то смысл сортировки теряется. 
Именно для решения данной задачи, то есть определения типа мусора, создана моя программа. 

## Дата-сет

В наше время люди очень ленивые, поэтому при выбросе мусора они не хотят прилагать много усилий. Самое простое - это поднести свой мусор к специальному аппарату, 
для того, чтобы он моментально сфотографировал и выдал результат (например, голосовое оповещение).
Это как аппарат в Пятёрочке, который говорит к какому классу относится ваш мусор.
Поэтому было принято решение - искать размеченный датасет с фотографиями.
Ссылка на датасет: https://www.kaggle.com/xjy110906727697/rubbish-classfication

Как видно данный датасет представляет собой сборник фотографий, разбитых на 6 классов:
-Картон
-Стекло
-Метал 
-Бумага
-Пластик
-Несортируемое 

Общее количество всех фотографий = 2517. 
Фотографий не очень много, поэтому для повышения точности пришлось поработать.
Было принято решение - удалить фон. Для этого была написана программа DeleteFon.py (с вспомогательным модулем _utils.py)

За основу была взята статья: https://www.rame0.ru/2019/11/23/%D1%83%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D1%84%D0%BE%D0%BD%D0%B0-%D1%81-%D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F/

Обучаю на датасете с фотографиями без фона.

## Что на входе и на выходе

От моей программы требуется только одно - определить тип мусора по фотографии. 
На входе: Фотография
На выходе: Тип мусора (один из 6 классов)

Разумеется для проверки результата я использовал свои фотографии. Это нагляднее. 

## Как решается задача

Я разбил задачу на 2 этапа:
1) Составление модели (ноутбук ToModel)
2) Предсказание результата используя готовую модель (ноубук FromModel)

На первом этапе происходит обучение модели (это достаточно длительный процесс, поэтому и было предпринято решение разбить задачу на 2 этапа).
Для этого я беру размеченные фотографии без фона (папка dataset-resized_back) и обучаю на них свою модель. 
Для оценки результата использовал метрику acc (или accuracy), которая вычисляет, как часто прогнозы совпадают с метками. 
Также на данном этапе я выбрал несколько своих вотографий и удалил с них фон (создание папки MyRubbish_back/Rubbish_back).

После долгого обучения я сохраняю модель и перехожу ко второму этапу.
Он очень простой. Я открываю модель и подаю на вход свои данные. 
После чего вывожу фотографии и результат.

## Примерное время обучения

Для того, чтобы удалить фон со всего датасета мне пришлось ждать всю ночь.
Для того, чтобы обучить модель на 20+ эпохах ждал чуть больше часа. 
(Разумеется, можно было воспользоваться google Colab с GPU ускорителем, но об этом я узнал позже)

Зато предсказание результата происходит за считанные секунды.

## Результаты

Специально вывел 9 фотографий своего собственного мусора. (Сверху над фотографией пишется предсказанный класс) 

Как видно, модель иногда путает Картон и Пластик, но в целом результаты достойные. 7/9 верных предсказаний.

## Анализ

Можно увеличить датасет, это точно увеличит процент правильных предсказаний. 
Также можно изменить параметры модели (например, увеличить количество слоёв) или количество эпох (20 это не предел), 
но эти изменения не приводят к заметному улучшению результата, основная проблема состоит в размере датасета.